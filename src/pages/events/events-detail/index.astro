---
// import '../../styles/global.css';
import eventsData from '../../../data/eventsData.json';
type Event = {
    id: string;
    title: string;
    category: string;
    start: string;
    end: string;
    place: string;
    award: string;
    speaker: string;
    youtube: string;
    links: { label: string; source: string; href: string; }[];
    participants: string;
    keyword: string[];
    desc: string;
    photos: string[];
    time: string;
}

---
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Events | Urban AI Institute (UAII)</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fcfcfc;
        }
        .serif-title {
            font-family: 'Playfair Display', serif;
        }
        .markdown p { margin-bottom: 1.25rem; line-height: 1.8; color: #374151; }
        .markdown strong { color: #1e3a8a; font-weight: 700; }
        .newspaper-border {
            border-top: 4px solid #000;
            border-bottom: 1px solid #000;
        }
    </style>
</head>
<body class="text-slate-900">

    <!-- Simple Nav -->
    <nav class="border-b border-slate-100 bg-white/80 backdrop-blur-md sticky top-0 z-50">
        <div class="container mx-auto px-6 py-6 flex justify-between items-center">
            <a href="index.html"><div class="text-xl font-black tracking-tighter text-blue-900">UAII <span class="text-slate-400 font-light">EVENTS</span></div></a>
            <div class="flex gap-6 text-xs font-bold uppercase tracking-widest text-slate-500">
                <a href="index.html" class="hover:text-blue-600">Home</a>
                <a href="people.html" class="hover:text-blue-600">People</a>
                <a href="projects.html" class="hover:text-blue-600">Projects</a>
                <a href="apply.html" class="hover:text-blue-600">Apply</a>
                <a href="press.html" class="hover:text-blue-600">Events</a>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-6 max-w-6xl py-12">
        <!-- Newspaper Header Style -->
        <header class="text-center mb-16">
            <div class="newspaper-border py-4 mb-4">
                <h1 class="serif-title text-5xl md:text-7xl font-black tracking-tight">EVENTS in Detail</h1>
            </div>
            <div class="flex justify-between items-center text-[10px] font-bold uppercase tracking-[0.3em] text-slate-400 px-2">
                <span>Daejeon, South Korea</span>
                <span>URBAN ARTIFICIAL INTELLIGENCE INSTITUTE</span>
                <span id="current-date">January 2026</span>
            </div>
        </header>

        <article class="py-16">
            <!-- Main Content Area -->
            <div class="max-w-5xl mx-auto">
                    

                <!-- Events Gallery -->
                <section id="events-gallery" class="mt-52">
                    <div class="flex items-center gap-8 mb-12">
                        <h2 class="serif-title text-3xl font-bold whitespace-nowrap">Events Gallery</h2>
                        <div class="h-px bg-slate-200 w-full"></div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8" id="events-gallery-list">
                        <!-- Events gallery will be injected here -->
                    </div>

                    <!-- Pagination -->
                    <div id="pagination" class="flex items-center justify-center gap-2 mt-8 mb-8">
                        <!-- Pagination buttons will be injected here -->
                    </div>
                </section>
            </div>

        </article>


    </main>



    <!--<footer class="bg-white border-t border-slate-100 py-12 mt-24">
        <div class="container mx-auto px-6 text-center">
            <p class="text-[10px] font-bold uppercase tracking-widest text-slate-400">¬© 2026 URBAN AI INSTITUTE (UAII) - KAIST</p>
        </div>
    </footer>-->
    <footer class="bg-white border-t border-gray-200 py-8 text-center mt-20">
        <p class="text-gray-500 text-sm">&copy; 2026 Urban AI Institute. All rights reserved.</p>
    </footer>

    <script define:vars={{ eventsData }}>
        // Load data from eventsData.json


        function formatDate(start, end) {
            const daySuffix = (day) => {
                if (day > 3 && day < 21) {
                    return 'th';
                }
                switch (day % 10) {
                    case 1:
                    return 'st';
                    case 2:
                    return 'nd';
                    case 3: 
                    return 'rd';
                    default:
                    return 'th';
                }
            }
            const startDate = new Date(start);
            const startDay = startDate.getDate();
            const startDaySuffix = daySuffix(startDay);
            const startMonth = startDate.toLocaleDateString('en-US', { month: 'long' });
            const startYear = startDate.getFullYear();

            const endDate = new Date(end);
            const endDay = endDate.getDate();
            const endDaySuffix = daySuffix(endDay);
            const endMonth = endDate.toLocaleDateString('en-US', { month: 'long' });
            const endYear = endDate.getFullYear();

            if (startYear !== endYear){
                return `${startMonth} ${startDay}${startDaySuffix}, ${startYear}-${endMonth} ${endDay}${endDaySuffix}, ${endYear}`;
            }else if (startMonth !== endMonth){
                return `${startMonth} ${startDay}${startDaySuffix}-${endMonth} ${endDay}${endDaySuffix}, ${startYear}`;
            }else if (startDay !== endDay){
                return `${startMonth} ${startDay}${startDaySuffix}-${endDay}${endDaySuffix}, ${startYear}`;
            }else{
                return `${startMonth} ${startDay}${startDaySuffix}, ${startYear}`;
            }
            return `${startMonth} ${startDay} ${startDaySuffix}, ${startYear}`
            
        }


        async function init() {
            try {
                renderEventsGallery();
            } catch (error) {
                console.error('Error initializing page:', error);
            }
        }

        

        let currentPage = 1;
        const eventsPerPage = 9;

        function renderEventsGallery(page = 1) {
            const galleryList = document.getElementById('events-gallery-list');
            const pagination = document.getElementById('pagination');
            if (!galleryList || !eventsData || eventsData.length === 0) return;

            // Sort events by date (newest first)
            const sortedEvents = [...eventsData].sort((a, b) => (b.start || '').localeCompare(a.start || ''));

            // Calculate pagination
            const totalPages = Math.ceil(sortedEvents.length / eventsPerPage);
            currentPage = Math.max(1, Math.min(page, totalPages));

            // Get events for current page
            const startIndex = (currentPage - 1) * eventsPerPage;
            const endIndex = startIndex + eventsPerPage;
            const pageEvents = sortedEvents.slice(startIndex, endIndex);

            // Clear existing content
            galleryList.innerHTML = '';

            // Render events
            pageEvents.forEach((event, index) => {
                const card = document.createElement('a');
                card.href = `/events/events-detail/${event.id}`;
                card.className = "group cursor-pointer block animate-fade-in-up";
                card.style.animationDelay = `${index * 0.05}s`;

                const eventDate = event.end ? `${formatDate(event.start, event.end)}` : formatDate(event.start);
                const categoryLabel = event.category ? event.category.charAt(0).toUpperCase() + event.category.slice(1) : 'Event';
                const photo = event.photos && event.photos.length > 0 ? event.photos[0] : '';
                const shortDesc = event.desc ? event.desc.split('\n')[0].substring(0, 120) + '...' : '';

                card.innerHTML = `
                    <div class="bg-white rounded-lg shadow-sm border border-slate-100 overflow-hidden group-hover:shadow-lg group-hover:border-blue-500/30 transition-all duration-300 h-full">
                        ${photo ? `
                            <div class="relative h-48 overflow-hidden">
                                <img src="${photo}" alt="${event.title}" class="w-full h-full object-cover group-hover:scale-110 transition duration-500">
                                <div class="absolute top-3 left-3">
                                    <span class="bg-blue-900 text-white text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-widest">${categoryLabel}</span>
                                </div>
                            </div>
                        ` : `
                            <div class="h-48 bg-gradient-to-br from-blue-50 to-slate-100 flex items-center justify-center">
                                <span class="bg-blue-900 text-white text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-widest">${categoryLabel}</span>
                            </div>
                        `}
                        <div class="p-6">
                            <div class="text-xs text-slate-400 mb-2">${eventDate}</div>
                            <h3 class="text-lg font-bold text-slate-900 mb-2 group-hover:text-blue-900 transition-colors line-clamp-2">${event.title}</h3>
                            ${shortDesc ? `<p class="text-sm text-slate-600 line-clamp-2 mb-3">${shortDesc}</p>` : ''}
                            ${event.place ? `<div class="text-xs text-slate-500 flex items-center gap-1">
                                <span>üìç</span>
                                <span class="line-clamp-1">${event.place}</span>
                            </div>` : ''}
                        </div>
                    </div>
                `;

                galleryList.appendChild(card);
            });

            // Render pagination
            pagination.innerHTML = '';

            if (totalPages <= 1) {
                return; // No pagination needed
            }

            // Previous button
            const prevBtn = document.createElement('button');
            prevBtn.className = `px-4 py-2 rounded-md border border-slate-300 text-sm font-medium transition-colors ${
                currentPage === 1 
                    ? 'bg-slate-100 text-slate-400 cursor-not-allowed' 
                    : 'bg-white text-slate-700 hover:bg-slate-50 hover:border-blue-500'
            }`;
            prevBtn.textContent = 'Previous';
            prevBtn.disabled = currentPage === 1;
            prevBtn.addEventListener('click', () => {
                if (currentPage > 1) {
                    renderEventsGallery(currentPage - 1);
                    window.scrollTo({ top: document.getElementById('events-gallery').offsetTop - 100, behavior: 'smooth' });
                }
            });
            pagination.appendChild(prevBtn);

            // Page numbers
            const maxVisiblePages = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);

            if (endPage - startPage < maxVisiblePages - 1) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }

            // First page
            if (startPage > 1) {
                const firstBtn = document.createElement('button');
                firstBtn.className = 'px-3 py-2 rounded-md border border-slate-300 bg-white text-sm font-medium text-slate-700 hover:bg-slate-50 hover:border-blue-500 transition-colors';
                firstBtn.textContent = '1';
                firstBtn.addEventListener('click', () => {
                    renderEventsGallery(1);
                    window.scrollTo({ top: document.getElementById('events-gallery').offsetTop - 100, behavior: 'smooth' });
                });
                pagination.appendChild(firstBtn);

                if (startPage > 2) {
                    const ellipsis = document.createElement('span');
                    ellipsis.className = 'px-2 text-slate-500';
                    ellipsis.textContent = '...';
                    pagination.appendChild(ellipsis);
                }
            }

            // Page number buttons
            for (let i = startPage; i <= endPage; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.className = `px-3 py-2 rounded-md border text-sm font-medium transition-colors ${
                    i === currentPage
                        ? 'bg-blue-900 text-white border-blue-900'
                        : 'bg-white text-slate-700 border-slate-300 hover:bg-slate-50 hover:border-blue-500'
                }`;
                pageBtn.textContent = i;
                pageBtn.addEventListener('click', () => {
                    renderEventsGallery(i);
                    window.scrollTo({ top: document.getElementById('events-gallery').offsetTop - 100, behavior: 'smooth' });
                });
                pagination.appendChild(pageBtn);
            }

            // Last page
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    const ellipsis = document.createElement('span');
                    ellipsis.className = 'px-2 text-slate-500';
                    ellipsis.textContent = '...';
                    pagination.appendChild(ellipsis);
                }

                const lastBtn = document.createElement('button');
                lastBtn.className = 'px-3 py-2 rounded-md border border-slate-300 bg-white text-sm font-medium text-slate-700 hover:bg-slate-50 hover:border-blue-500 transition-colors';
                lastBtn.textContent = totalPages;
                lastBtn.addEventListener('click', () => {
                    renderEventsGallery(totalPages);
                    window.scrollTo({ top: document.getElementById('events-gallery').offsetTop - 100, behavior: 'smooth' });
                });
                pagination.appendChild(lastBtn);
            }

            // Next button
            const nextBtn = document.createElement('button');
            nextBtn.className = `px-4 py-2 rounded-md border border-slate-300 text-sm font-medium transition-colors ${
                currentPage === totalPages 
                    ? 'bg-slate-100 text-slate-400 cursor-not-allowed' 
                    : 'bg-white text-slate-700 hover:bg-slate-50 hover:border-blue-500'
            }`;
            nextBtn.textContent = 'Next';
            nextBtn.disabled = currentPage === totalPages;
            nextBtn.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    renderEventsGallery(currentPage + 1);
                    window.scrollTo({ top: document.getElementById('events-gallery').offsetTop - 100, behavior: 'smooth' });
                }
            });
            pagination.appendChild(nextBtn);
        }


        document.addEventListener("DOMContentLoaded", () => {
            init();
        });
    </script>
</body>
</html>